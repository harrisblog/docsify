## 汇编语言程序设计概述

### 程序设计语言

1. **机器语言**：用二进制表示，能够被机器直接识别

2. **汇编语言**：采用**助记符**表示机器指令

3. **高级语言**：接近自然语言

### 汇编语言源程序

通常以**.asm**作为文件扩展名。汇编语言程序设计中由于开发环境支持不同，可以有**完整段程序**和简化段程序。

### 汇编语言程序开发过程

基本步骤是：**编辑**(xxx.asm)、**汇编**(xxx.obj)、**连接**(xxx.exe)、调试运行

## 汇编语言基本语法 ⭐

### 汇编语言的语句类型

1. **指令性语句**：由指令构成，与机器指令一一对应。

	 `[标号:] 操作码 操作数 [;注释]`

	 如: `START: MOV AX ,DATA  ;初始化数据段`

2. **指示性语句**：由命令（伪指令）构成，是程序员发给汇编程序的命令，没有相应的机器指令。

	 `[名字] 伪指令 [操作数] [;注释]`

	 如: `DATA SEGMENT`

### 二、常量、标识符和表达式

#### 常量

指令中出现的固定值，在程序运行期间不会变化。分为**数字常量**、**字符常量**和**符号常量**三种。(指令中的立即数，MEM直接地址)

##### 数字常量

直接用数字表示的常量。

二进制：10000100B、11110001020100B

十进制：12356D

十六进制：12ABH、0F56AH（<u>字母开头必须前面补0，否则将出现汇编语法错误</u>）

> 例如：
>
> MOV AX，100D
>
> MOV BL，0FAH

##### 字符串常量

包含在<u>单引号</u>内的<u>一个或两个</u>ASCII字符构成，它所代表的数值就是该字符的ASCII码。

例如字符'A'等价于41H，字符'AB'等价于4142H。

> 例如：
>
> MOV   AL, <u>'A'</u>
>
> MOV   AX, <u>'AB'</u>

##### 符号常量

用标识符（常量名）表示的常量，它具有一个设定的数值从而被引用。

#### 标识符

有特定意义的字符序列，标识符可用作符号常量、名字、变量和标号等。

标识符**命名规则**和C语言类似，不过多赘述。

#### 表达式 

由操作数（常量、变量、标号）和运算符构成。

在汇编时完成相应的运算(数字常数)，（OBJ）目标程序中不存在表达式，应用程序的DEBUG调试中不可能看到任何表达式。

<img src="F:/360MoveData/Users/Administrator/Pictures/%E5%8D%9A%E5%AE%A2%E4%B8%93%E7%94%A8/CDN/posts/Microcomputer_Note/image-20210406170238311.png" style="zoom: 80%;" />

例如：

**AND** AL, 86H <u>AND</u> 0FH

**AND**是指令；

<u>AND</u>是逻辑运算符，86H AND 0FH=06H

汇编后的指令是：AND  AL, 06H

> **注意：**
>
> - 逻辑运算符只能对常数（或相当于常数）进行运算。
>
> - 与逻辑运算指令不同, CPU不执行任何操作，汇编时运算，在目标程序中只是一个常数。

### 三、汇编语言程序伪指令 ⭐

#### 程序结束伪指令

**格式**：END  标号

**说明**：标号为程序中第一条指令性语句标号

#### 段定义伪指令

8086分段访问存储器。

##### 段定义语句

**格式**：

```assembly
段名 SEGMENT [定位方式][组合方式]['类别名']
...
段名 ENDS
```

**例如**：

```assembly
DATA SEGMENT
...
DATA ENDS
CODE SEGMENT
...
CODE ENDS
```

定义了二个段，段名分别为DATA、CODE。

**说明**：定义数据段、附加数据段和堆栈段时，处于SEGMENT/ENDS伪指令中间的语句，只能包括伪指令语句，不能包括指令语句。

#### 段寄存器说明伪指令  

**格式**：ASSUME  段寄存器：段名1，段寄存器：段名2……

**说明**：在代码段，告诉汇编程序CS、DS、ES、SS应具有的符号段基址，但是段寄存器（CS除外）还必须用传送指令赋值。一般紧跟在SEGMENT语句之后。

#### 过程定义的伪指令

**格式**： 

```assembly
过程名 PROC NEAR[FAR]
...
过程名 ENDP
```

**说明**：

NEAR 近过程（主、子同段）

FAR  远过程（主、子在两个不同的代码段）

#### 数据定义伪指令

数据定义语句用来为数据分配存储单元，数据段、附加段和堆栈段都是存放数据的，其中所用的语句主要是数据定义语句。

**格式**：[变量名] 命令  参数1，参数2，… [；注释]

> **说明**： 
>
> **变量名**是由程序员在编程时按标识符规定取的。

命令：表示符号及功能如下：

**DB** 字节 （8位）一个字节存贮单元

**DW** 字 （16位）二个连续字节存贮单元

DD 双字 （32位）四个连续字节存贮单元

DQ 双字 （64位）8个连续字节存贮单元

DT 双字 （80位）10个连续字节存贮单元

**参数**：相应内存单元中的数据，可以是数字常量、字符常量或符号常量，当它是保留时就以问号（?）表示。参数可以有多个，相互间用逗号（,）隔开，若连续多个数据是重复的，可用复制符DUP以简化书写，DUP的用法为：

<u>复制次数  DUP（数据）</u>

> 例如： ARRAY  DB  10  DUP(12H)

> 提示：字符'A'是41H，'B'是42H，以此类推

> 注意：除用DB定义的字符串常量外，单引号中ASCII字符的个数<u>不得超过2个</u>，若只有1个，如 DW ‘C’，就相当于 DW 0043H。

#### 符号定义伪指令

##### 应用命令EQU和PURGE

**格式**：符号常量 EQU 表达式

**说明**：如需对已赋值的名字<u>赋以新值</u>，则先用PURGE语句撤销原赋值。

其格式为：`PURGE 名字`

> PURGE可同时撤销几个已赋值。

**例如**：

```assembly
COUNT	EQU  20
ADD		AX,COUNT
PURGE	COUNT
COUNT	EQU  30
ADD		AX,COUNT
```

##### 应用命令"="

**格式**： 符号常量=表达式

**说明**：其功能与EQU类似，唯一的区别是命令"="可<u>随时对名字赋新值</u>，而不必使用PURGE命令。

**例如**：

```assembly
COUNT = 20
ADD	AX,COUNT
COUNT = 30
ADD	AX,COUNT
```

#### 变量

##### "$"的含义

```assembly
DATA SEGMENT
ARRAY DB 10H,5AH,0C7H,98H,'ABCD'
COUNT EQU $-ARRAY
MAX DB 12H
DATA ENDS
```

> 说明：$表示该行的偏移地址，此处COUNT表示ARRAY有多少个元素。

##### 变量的五种属性

###### 段基址

**格式**：SEG   符号名

**例如**：MOV  AX,SEG  AA 

**说明**：SEG AA 为立即寻址，是AA的**段地址**

###### 偏移地址

**格式**：OFFSET  符号名

**例如**：MOV  SI,OFFSET  BB  

**说明**：OFFSET BB 为立即寻址,是BB的**偏移地址**

###### 类型指定运算符PTR

**格式**：类型 PTR 表达式

**说明**：类型可以是**BYTE、WORD**、DWORD、NEAR、FAR

**作用**：按PTR前面指定的类型去寻址

**例如**： INC  BYTE  PTR  [2000H]

### 四、DOS系统功能调用 ⭐





## 汇编语言程序设计 ⭐😱



